{% extends "base.html" %}

{% block content %}
<section class="intro">
    <h1>Scanning the IPv6 Internet using Subnet-Router Anycast Probing</h1>
    <p>
        We propose a commonly unused method to probe the IPv6 address space. Instead of random probing, we probe the Subnet-Router anycast address of a subnet.
        Subnet-Router anycast addresses are defined in <a href="https://doi.org/10.17487/RFC1884">RFC 1884</a>.
        By probing the SRA address of a subnet, we significantly lower the impact of ICMP error message rate limiting, as probing these addresses can trigger ICMP Echo replies.
        This webpage presents our most recent results from our regular scans.
        We provide a list of the found router IPv6 addresses as well as information on current routing loop deployment and ICMP time exceeded amplification in IPv6.
    </p>
</section>

<section class="tiles">
    <div class="tile-row tile-row-two first-row">
        <div class="tile metric-tile metric-hitlist">
            <div class="metric-hitlist-info">
                <h2 class="metric-value" data-target="{{ metrics.router_ips }}">{{ metrics.router_ips|si }}</h2>
                <p>Observed Router IPv6 Addresses with Subnet-Router Anycast Probing</p>
            </div>
            <div class="hitlist-action-group">
                <a class="hitlist-download" href="{{ url_for('static', filename='data/router-hitlist.csv.zst') }}" download>
                    <svg viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M12 3v11m0 0l-4-4m4 4l4-4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M5 15v4h14v-4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    SRA Router IP Addresses
                </a>
            </div>
        </div>
        <div class="tile overlap-tile">
            <div class="overlap-circle">
                <svg viewBox="0 0 120 120">
                    <circle class="overlap-bg" cx="60" cy="60" r="52"></circle>
                    <circle class="overlap-progress" cx="60" cy="60" r="52" data-percentage="{{ metrics.overlap_percentage }}"></circle>
                    <text x="60" y="55" text-anchor="middle">
                        <tspan class="overlap-value metric-value" data-target="{{ metrics.overlap_absolute }}">{{ metrics.overlap_absolute|si }}</tspan>
                        <tspan x="60" dy="26" class="overlap-percentage metric-value metric-percentage" data-target="{{ metrics.overlap_percentage }}">{{ '{:.1f}%'.format(metrics.overlap_percentage) }}</tspan>
                    </text>
                </svg>
            </div>
            <p>Router IP Addresses Overlapping with the <a href="https://ipv6hitlist.github.io">TU Munich IPv6 Hitlist</a></p>
        </div>
    </div>
    
    <div class="tile tile-plot-group">
        <h2>Routing Loops and Amplification in IPv6</h2>
        <div class="plot-row">
            <figure>
                <img src="{{ url_for('static', filename='data/figures/looping-subnets-per-router-rank.png') }}" alt="Looping subnets per router rank plot">
                <figcaption>Number of /48 subnets per router IP address that trigger a routing loop.</figcaption>
            </figure>
            <figure>
                <img src="{{ url_for('static', filename='data/figures/amplification-routingloops.png') }}" alt="Amplification vs routing loops plot">
                <figcaption>Maximum amplification per router IP address.</figcaption>
            </figure>
        </div>
        <div class="plot-metric-grid">
            <div class="plot-metric">
                <h3 class="metric-value" data-target="{{ metrics.looping_subnets }}">{{ metrics.looping_subnets|si }}</h3>
                <p>/48 Subnets that trigger Routing Loops</p>
            </div>
            <div class="plot-metric">
                <h3 class="metric-value" data-target="{{ metrics.amplifying_subnets }}">{{ metrics.amplifying_subnets|si }}</h3>
                <p>/48 Subnets that trigger Amplification</p>
            </div>
            <div class="plot-metric">
                <h3 class="metric-value" data-target="{{ metrics.max_amplification }}">{{ metrics.max_amplification|si }}</h3>
                <p>Maximum Observed Amplification Factor</p>
            </div>
        </div>
        <div class="as-checker">
            <form id="as-checker-form" class="as-checker-form" action="{{ url_for('index') }}" method="post">
                <label for="asn-input">Your AS Number:</label>
                <input id="asn-input" name="asn" type="number" min="0" step="1" placeholder="e.g., 3320" required value="{{ submitted_asn }}">
                <button type="submit" class="as-checker-submit">Check if your network is affected</button>
            </form>
            <div id="as-checker-result" class="as-checker-result{% if as_result %} visible {{ as_result.state }}{% endif %}" role="status" aria-live="polite">
                {% if as_result %}
                    {{ as_result.message }}
                {% endif %}
            </div>
        </div>
    </div>
    <div class="tile tile-plot-full">
        <h2>World Map of IPv6 Router IP Addresses found with SRA Probing</h2>
        <img src="{{ url_for('static', filename='data/figures/worldmap-sra-ips.png') }}" alt="World map of SRA IPv6 addresses">
    </div>
    <div class="tile tile-plot-full">
        <h2>Comparison of Network Types across multiple IPv6 Address Data Sources</h2>
        <img src="{{ url_for('static', filename='data/figures/heatmap-network-types-all-sources.png') }}" alt="World map of SRA IPv6 addresses">
    </div>
    <div class="tile tile-reference">
        <h2>If you are using our data, please cite us using the following reference:</h2>
        {% for ref in references %}
        <div class="reference-entry">
            <pre><code>{{ ref }}</code></pre>
            <button class="copy-reference">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M8 7V5a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2h-2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <rect x="3" y="7" width="13" height="14" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Copy
            </button>
        </div>
        {% else %}
        <p>No references available.</p>
        {% endfor %}
    </div>
</section>

<script src="{{ url_for('static', filename='js/charts.js') }}"></script>
{% endblock %}
